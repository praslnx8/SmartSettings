@startuml

package UI {
class Home {

}

note left of Home {
    App main UI.
}

interface SmartSettingProvider {
    + View getInputView((SmartSetting))
}

note right of SmartSettingChooser
UI for showing list of smart setting types available.
end note

SmartSettingChooser *-- SmartSettingProvider

}

abstract class SmartSetting<CONTEXT, CRITERIA, ACTION> {
    - CRITERIA criteriaData
    - ACTION actionData
    - boolean isRunning
    + boolean isRunning()
    + void start()
    + void stop()
    # abstract void applySettingChanges()
    # abstract Listener<CONTEXT> getListener()
    # abstract void isCriteriaMatching(CRITERIA criteriaData, CONTEXT contextData)
    + abstract void askSettingChangePermissionIfAny((Boolean))
    - void startListenForContextChanges((CONTEXT))
    - void stopListeningToContextChanges()
}

abstract class Listener<T> {
    # abstract void startListenForContextChanges((Boolean))
    # abstract void stopListeningToContextChanges()
    + abstract void askListeningPermissionIfAny()
    - onContextChange(T contextData)
}

SmartSetting *-- Listener

SmartSettingProvider .. SmartSetting

class SmartProfile <<(S,red) Singleton>> {
    - Map<SmartSetting, Boolean> smartSettings
    + void enableSmartSetting(SmartSetting smartSetting)
    + void disableSmartSetting(SmartSetting smartSetting)
    + Map<SmartSetting, Boolean> getSmartSettingsLiveData()
    - void persistSmartSettingToMemory()
    - void reInitializeSmartSettingsFromMemory()
}

note right of SmartProfile
Singleton object.
end note

SmartProfile o-- SmartSetting : has List of created smart setting

class SmartSettingChooser {
    - List<SmartSettingProvider> smartSettingProvider;
}

Home .. SmartProfile : enables/diabled smartSetting
Home o-- SmartSettingChooser : asks to provide SmartSetting

class MainService<<(S,red) Singleton>> {
    - void startSmartSettings()
    - void stopSmartSettings()
}

note left of MainService
Never ending non ui process
end note

MainService .. SmartProfile : start/stop the smartSettings

Home .. MainService : Starts service

class SmartSettingRepository {
    + void getSmartSettingsLiveData()
}

SmartProfile o-- SmartSettingRepository

@enduml